{% extends "base.html" %}

{% block content %}

<h2>{{ description }}</h2>
<h2>{{ time }} start</h2>
<p>Fixture owner: {{ owner.FirstName }} {{ owner.LastName }}</p>
<p>Courts: {{ courts }}</p>
<a class="pure-button" href="fixtureeditform?fixtureid={{ fixtureid }}">Edit fixture data</a>
<br><br>

{% set linkbase = 'participant?fixtureid=' ~ fixtureid ~ '&userid=' %}

{% if players|length >0 %}
<p><b>Playing:</b></p>
<ol>
    {% for n in players %}
    <li><a href="{{ linkbase }}{{ n.Userid }}">
        {{ n.FirstName }} {{ n.LastName }}</a></li>
    {% endfor %}
</ol>
{% endif %}

{% if reserves|length >0 %}
<p><b>Would like to play:</b></p>
<ol>
    {% for n in reserves %}
    <li><a href="{{ linkbase }}{{ n.Userid }}">
        {{ n.FirstName }} {{ n.LastName }}</a></li>
    {% endfor %}
</ol>
{% endif %}

{% if decliners|length >0 %}
<p><b>Can't play:</b></p>
<ol>
    {% for n in decliners %}
    <li><a href="{{ linkbase }}{{ n.Userid }}">
        {{ n.FirstName }} {{ n.LastName }}</a></li>
    {% endfor %}
</ol>
{% endif %}


{% if abstainers|length >0 %}
<details>
    <summary>{{ abstainers|length }} people haven't responded</summary>
    <ol>
    {% for n in abstainers %}
    <li><a href="{{ linkbase }}{{ n.Userid }}">
        {{ n.FirstName }} {{ n.LastName }}</a></li>
    {% endfor %}
    </ol>
</details>
{% endif %}

<br>

{% if players|length >0 or reserves|length >0 or abstainers|length >0 %}
<a class="pure-button" href="fixturewantstoplayform?fixtureid={{ fixtureid }}">Set wants to play</a>
<a class="pure-button" href="fixturesetbookersplaying?fixtureid={{ fixtureid }}">Set bookers playing</a>
<br><br>
<a class="pure-button" href="fixturesetplayingform?fixtureid={{ fixtureid }}">Set playing</a>
<a class="pure-button" href="fixtureresetplaying?fixtureid={{ fixtureid }}">Reset playing</a>
<br><br>
<a class="pure-button" href="fixturedelusersform?fixtureid={{ fixtureid }}">Remove</a>
{% else %}
<p>No participants</p>
{% endif %}
<a class="pure-button" href="fixtureaddusersform?fixtureid={{ fixtureid }}">Add</a>
<br><br>

{% if inBookingWindow >= 0 %}
    {% if bookings|length >1 %}
        <b>Booked courts...</b><br>
        <table class="pure-table">
        {% for key, r in bookings %}
        {% if key == 0 %}<thead>{% endif %}
        <tr>
        {% for c in r %}
        {% if key == 0 %}
            <th>{{ c }}</th>
        {% else %}
            <td>{{ c }}</td>
        {% endif %}
        {% endfor %}
        {% if key == 0 %}</thead>{% endif %}
        {% endfor %}
        </table>
    {% else %}
        No bookings<br>
    {% endif %}
{% endif %}

{% if inBookingWindow != 0 %}
    {{ include('requestedBookings.html') }}
    <br>
    <a class="pure-button" href="fixtureAddRequests?fixtureid={{ fixtureid }}">Add booking request</a>
    <br><br>
{% endif %}

{% if invitationsSent == 0  and abstainers|length >0 %}
<br><br>
<a class="pure-button" href="emailConfirm?fixtureid={{ fixtureid }}">Email invitations</a>
{% endif %}

<br><br>
<a class="pure-button" href="fixturenotice?fixtureid={{ fixtureid }}" target="_blank">Review fixture notice</a>

<br><br>
<a class="pure-button" href="series?seriesid={{ seriesid }}">Back to series</a>

{% if Role == 'Admin' %}
<br><br>
<a class="pure-button" 
href="fixturedeleteform?seriesid={{ seriesid }}&fixtureid={{ fixtureid }}">Delete fixture</a>
{% endif %}

<br><br><br><br>

{% endblock %}